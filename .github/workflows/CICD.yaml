name: CI/CD

# mainì— push ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ íŠ¸ë¦¬ê±°ê°€ ë˜ì–´ì„œ workflow ì‹¤í–‰ ë¨
on:
  push:
    branches:
    - main

# ì—¬ëŸ¬ê°œì˜ jobì„ ì„¤ì •í•  ìˆ˜ ìˆì§€ë§Œ ì—¬ê¸°ì„  cicd jobë§Œ ì„¤ì • í–ˆìŠµë‹ˆë‹¤. 
jobs:
  cicd:
    # ì‹¤í–‰ë˜ëŠ” ì„œë²„ ì •ë³´ (ê·¸ëŒ€ë¡œ ì“°ë©´ ë©ë‹ˆë‹¤.)
    runs-on: ubuntu-latest
    # ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤!
    steps:
    # nameì€ ì‹¤í–‰ë  ë•Œ ëœ¨ëŠ” ì•ˆë‚´ë¬¸? ê°™ì€ê±°ê³  ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ëª…ë ¹ë¬¸ì€ usesë‚˜ runì— ì‘ì„±ëœ ë‚´ìš©ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.
    - name: Git checkoutğŸ˜‰
			# actions/checkout@v3ì´ ìµœì‹  ë²„ì „ì´ì§€ë§Œ ì—ëŸ¬ê°€ ë‚˜ì„œ v2ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤..! v3ë¡œ í•´ë³´ê³  ì•ˆë˜ë©´ ë‹¤ìš´ê·¸ë ˆì´ë“œ í•˜ë©´ ë©ë‹ˆë‹¤.
      uses: actions/checkout@v3
    - name: Run "âœï¸ Remove node_modules and Install node packages"
      run: npm ci
    - name: Run "âš’ï¸ Project build"
      run: npm run build
    - name: Run "ğŸš€ Deploy to S3"
			# ì—¬ê¸°ë¶€í„´ S3ì— ë°°í¬í•˜ê¸° ìœ„í•œ ì„¸íŒ…ì…ë‹ˆë‹¤! jakejarvisê°€ ëˆ„êµ¬ì§€? ì‹¶ì§€ë§Œ ê·¸ëŒ€ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”
      uses: jakejarvis/s3-sync-action@master
      with:
        args: --delete
      env:
				# SOURCE_DIR: ë¹Œë“œí•˜ë©´ ìƒì„±ë˜ëŠ” í´ë” ì´ë¦„ì„ ì¨ì£¼ì„¸ìš”.
        AWS_S3_BUCKET: ${{ secrets.AWS_S3_BUCKET }}
        AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
        AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        AWS_REGION: 'ap-northeast-2'
        SOURCE_DIR: 'build'